<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CBMC: goto-programs</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CBMC
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__goto-programs.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">goto-programs</div>  </div>
</div><!--header-->
<div class="contents">
<h1><a class="anchor" id="autotoc_md112"></a>
Folder goto-programs</h1>
<dl class="section author"><dt>Author</dt><dd>Kareem Khazem, Martin Brain</dd></dl>
<h1><a class="anchor" id="goto-programs-overview"></a>
Overview</h1>
<p>Goto programs are the intermediate representation of the CPROVER tool chain. They are language independent and similar to many of the compiler intermediate languages. Each function is a list of instructions, each of which has a type (one of 19 kinds of instruction), a code expression, a guard expression and potentially some targets for the next instruction. They are not natively in static single-assign (SSA) form. Transitions are nondeterministic (although in practise the guards on the transitions normally cover form a disjoint cover of all possibilities). Local variables have non-deterministic values if they are not initialised. Goto programs can be serialised in a binary (wrapped in ELF headers) format or in XML (see the various <code>_serialization</code> files).</p>
<p>The <code>cbmc</code> option <code>--show-goto-functions</code> is often a good starting point as it outputs goto-programs in a human readable form. However there are a few things to be aware of. Functions have an internal name (for example <code>c::f00</code>) and a ‘pretty name’ (for example <code>f00</code>) and which is used depends on whether it is internal or being presented to the user. <code>NONDET(some_type)</code> is use to represent a nondeterministic value. <code>IF guard GOTO x</code> represents a GOTO instruction with a guard, not a distinct <code>IF</code> instruction. The comment lines are generated from the <code>source_location</code> field of the <code>instructiont</code> structure.</p>
<p>GOTO programs are commonly produced using the <code>initialize_goto_model</code> function, which combines the complete process from command-line arguments specifying source code files, through parsing and generating a symbol table, to finally producing GOTO functions.</p>
<p>Alternatively <code><a class="el" href="classlazy__goto__modelt.html" title="A GOTO model that produces function bodies on demand.">lazy_goto_modelt</a></code> can be used, which facilitates producing GOTO functions on demand. See <a class="el" href="group__goto-programs.html#section-lazy-conversion">Lazy GOTO Conversion</a> for more details on this method.</p>
<h1><a class="anchor" id="goto_data_structures"></a>
Data Structures</h1>
<p>A <a class="el" href="classgoto__functionst.html">goto_functionst</a> object contains a set of GOTO programs. Note the counter-intuitive naming: <code><a class="el" href="classgoto__functionst.html" title="A collection of goto functions.">goto_functionst</a></code> instances are the top level structure representing the program and contain <code><a class="el" href="classgoto__programt.html" title="A generic container class for the GOTO intermediate representation of one function.">goto_programt</a></code> instances which represent the individual functions.</p>
<p>An instance of <a class="el" href="classgoto__programt.html">goto_programt</a> is effectively a list of instructions (a nested class called <a class="el" href="classgoto__programt_1_1instructiont.html">goto_programt::instructiont</a>). It is important to use the copy and insertion functions that are provided as iterators are used to link instructions to their predecessors and targets and careless manipulation of the list could break these.</p>
<p>Individual instructions are instances of type <a class="el" href="classgoto__programt_1_1instructiont.html">goto_programt::instructiont</a>. They represent one step in the function. Each has a type, an instance of <a class="el" href="goto__program_8h.html#a9e03d66cd12c59d9d3daad1ec6296beb">goto_program_instruction_typet</a> which denotes what kind of instruction it is. They can be computational (such as <code>ASSIGN</code> or <code>FUNCTION_CALL</code>), logical (such as <code>ASSUME</code> and <code>ASSERT</code>) or informational (such as <code>LOCATION</code> and <code>DEAD</code>). At the time of writing there are 19 possible values for <code>goto_program_instruction_typet</code> / kinds of instruction. Instructions also have a guard field (the condition under which it is executed) and a code field (what the instruction does). These may be empty depending on the kind of instruction. These are of type <a class="el" href="classexprt.html">exprt</a> and <a class="el" href="classcodet.html">codet</a> respectively. The next instructions (remembering that transitions may be non-deterministic) are given by the list <code>targets</code> (with the corresponding list of labels <code>labels</code>) and the corresponding set of previous instructions is get by <code>incoming_edges</code>. Finally <code>instructiont</code> has informational <code>function</code> and <code>source_location</code> fields that indicate where they are in the source code.</p>
<h1><a class="anchor" id="goto-conversion"></a>
Goto Conversion</h1>
<p>In the <a class="el" href="group__goto-programs.html">goto-programs</a> directory.</p>
<p><b>Key classes:</b></p><ul>
<li><a class="el" href="classgoto__programt.html" title="A generic container class for the GOTO intermediate representation of one function.">goto_programt</a></li>
<li><a class="el" href="classgoto__functionst.html" title="A collection of goto functions.">goto_functionst</a></li>
<li><a class="el" href="classgoto__programt_1_1instructiont.html">goto_programt::instructiont</a></li>
</ul>
<div class="dotgraph">
<iframe scrolling="no" frameborder="0" src="dot_inline_dotgraph_17.svg" width="972" height="59"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<p>At this stage, CBMC constructs a goto-program from a symbol table. Each symbol in the symbol table with function type (that is, the symbol's <code>type</code> field contains a <a class="el" href="classcode__typet.html">code_typet</a>) will be converted to a corresponding GOTO program. The parse tree and source file are not used at all for this step.</p>
<p>The conversion happens in two phases:</p>
<ol type="1">
<li>Function <code><a class="el" href="classgoto__convertt.html#ac390d7621af14e22a4e9ac16bc7695e0" title="converts &#39;code&#39; and appends the result to &#39;dest&#39;">goto_convertt::convert</a></code> turns each <code>codet</code> in the symbol table into corresponding GOTO instructions.</li>
<li><code><a class="el" href="classgoto__convertt.html#a2e79544a60b6ad45440bf77cb385784e">goto_convertt::finish_gotos</a></code> and others populate the <code>GOTO</code> and <code>CATCH</code> instructions' <code>targets</code> members, pointing to their possible successors. <code>DEAD</code> instructions are also added when GOTO instructions branch out of one or more lexical blocks.</li>
</ol>
<p>Here is an example of a simple C program being converted into GOTO code (note the <code>targets</code> member of each instruction isn't populated yet):</p>
<div class="dotgraph">
<iframe scrolling="no" frameborder="0" src="dot_inline_dotgraph_18.svg" width="1270" height="1331"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<p>The <code>codet</code> representation of method bodies that is stored in the symbol table resembles C code quite strongly: it uses lexical variable scoping and has complex control-flow constructs such as <code><a class="el" href="classcode__whilet.html" title="codet representing a while statement.">code_whilet</a></code> and <code><a class="el" href="classcode__ifthenelset.html" title="codet representation of an if-then-else statement.">code_ifthenelset</a></code>. In converting to a GOTO program this structure is changed in several ways:</p>
<ul>
<li>Variable lifespan implied by <a class="el" href="classcode__declt.html">code_declt</a> instructions and lexical scopes described by <a class="el" href="classcode__blockt.html">code_blockt</a> nodes is replaced by <code>DECL</code> and corresponding <code>DEAD</code> instructions. There are therefore no lexical scopes in GOTO programs (not even local variable death on function exit is enforced).</li>
<li>Expressions with side-effects are explicitly ordered so that there is one effect per instruction (apart from function call instructions, which can still have many). For example, <code>y = f() + x++</code> will have become something like <code>tmp1 = f(); y = tmp1 + x; x = x + 1;</code></li>
<li>Compound blocks are eliminated. There are several subclasses of <a class="el" href="classcodet.html">codet</a> that count as 'compound blocks;' therefore, later stages in the CBMC pipeline that switch over the codet subtype of a particular instruction should not need to consider these types. In particular:<ul>
<li><p class="startli"><a class="el" href="classcode__ifthenelset.html" title="codet representation of an if-then-else statement.">code_ifthenelset</a> is turned into GOTOs. In particular, the bodies of the conditionals are flattened into lists of instructions, inline with the rest of the instruction in the <a class="el" href="classgoto__programt.html" title="A generic container class for the GOTO intermediate representation of one function.">goto_programt</a>. The guard of the conditional is placed onto the <a class="el" href="classgoto__programt_1_1instructiont.html#ad40b0425403000e60ccb647d5c7361f0">guard</a> member of an instruction whose code member is of type <a class="el" href="classcode__gotot.html">code_gotot</a>. The <a class="el" href="classgoto__programt_1_1instructiont.html#a633f4e32426cd72c4f338cc8ac178b8a">targets</a> member of that instruction points to the appropriate branch of the conditional. (Note that although instructions have a list of targets, in practice an instruction should only ever have at most one target; you should check this invariant with an assertion if you rely on it).</p>
<p class="startli">The order of instructions in a list of instructions&mdash;as well as the targets of GOTOs&mdash;are both displayed as arrows when viewing a goto-program as a Graphviz DOT file with <code>goto-instrument --dot</code>. The semantics of a goto-program is: the next instruction is the next instruction in the list, unless the current instruction has a target; in that case, check the guard of the instruction, and jump to the target if the guard evaluates to true.</p>
</li>
<li>switch statements, for and while loops, and try-catches are also transformed into lists of instructions guarded by GOTOs.</li>
<li><a class="el" href="classcode__blockt.html">code blocks</a> are transformed into lists of instructions.</li>
</ul>
</li>
<li><a class="el" href="classcode__returnt.html">return statements</a> are transformed into (unconditional) GOTOs whose target is the <a class="el" href="goto__program_8h.html#a9e03d66cd12c59d9d3daad1ec6296beba50b1efa8185f13d374262a5eb182a10d">END_FUNCTION</a> instruction. Each <a class="el" href="classgoto__programt.html" title="A generic container class for the GOTO intermediate representation of one function.">goto_programt</a> should have precisely one such instruction.</li>
</ul>
<h2><a class="anchor" id="subsection-goto-function-example"></a>
Example goto-program</h2>
<p>The following C program, in a file named <code>mult.c</code>:</p>
<div class="fragment"><div class="line">unsigned mult(unsigned a, unsigned b)</div>
<div class="line">{</div>
<div class="line">  int acc = 0, i;</div>
<div class="line">  for (i = 0; i &lt; b; i++)</div>
<div class="line">    acc += a;</div>
<div class="line">  return acc;</div>
<div class="line">}</div>
</div><!-- fragment --><p>is translated by <code>cbmc --show-goto-functions mult.c</code> into:</p>
<div class="fragment"><div class="line">mult /* mult */</div>
<div class="line">        // 0 file third.c line 2 function mult</div>
<div class="line">        signed int acc;</div>
<div class="line">        // 1 file third.c line 2 function mult</div>
<div class="line">        acc = 0;</div>
<div class="line">        // 2 file third.c line 2 function mult</div>
<div class="line">        signed int i;</div>
<div class="line">        // 3 file third.c line 3 function mult</div>
<div class="line">        i = 0;</div>
<div class="line">        // 4 file third.c line 3 function mult</div>
<div class="line">     1: IF !((unsigned int)i &lt; b) THEN GOTO 2</div>
<div class="line">        // 5 file third.c line 4 function mult</div>
<div class="line">        acc = (signed int)((unsigned int)acc + a);</div>
<div class="line">        // 6 file third.c line 3 function mult</div>
<div class="line">        i = i + 1;</div>
<div class="line">        // 7 file third.c line 3 function mult</div>
<div class="line">        GOTO 1</div>
<div class="line">        // 8 file third.c line 5 function mult</div>
<div class="line">     2: mult#return_value = (unsigned int)acc;</div>
<div class="line">        // 9 file third.c line 5 function mult</div>
<div class="line">        dead i;</div>
<div class="line">        // 10 file third.c line 5 function mult</div>
<div class="line">        dead acc;</div>
<div class="line">        // 11 file third.c line 6 function mult</div>
<div class="line">        END_FUNCTION</div>
</div><!-- fragment --><p>(The above result was produced using <code>cbmc version 5.11</code>)</p>
<h1><a class="anchor" id="section-goto-transforms"></a>
Subsequent Transformation</h1>
<p>It is normal for a program that calls <code>goto_convert</code> to immediately pass the GOTO functions through one or more transformations. For example, the ubiquitous <code>remove_returns</code> transformation turns the method return sequence generated by <code>goto_convert</code> (something like <code>RETURN x; GOTO end;</code>) into <code>function_name#return_value = x; GOTO end;</code>, and a callsite <code>y = function_name();</code> into <code>function_name(); y = function_name#return_value;</code>.</p>
<p>Some subsequent parts of the CBMC pipeline assume that one or more of these transforms has been applied, making them effectively mandatory in that case.</p>
<p>Common transformations include:</p>
<ul>
<li>Removing superfluous SKIP instructions (<code>remove_skip</code>)</li>
<li>Converting indirect function calls into dispatch tables over direct calls (<code>remove_virtual_functions</code> and <code>remove_function_pointers</code>)</li>
<li>Adding checks for null-pointer dereferences, arithmetic overflow and other undefined behaviour (<code>goto_check</code>)</li>
<li>Adding code coverage assertions (<code>instrument_cover_goals</code>).</li>
</ul>
<p>By convention these post-convert transformations are applied by a driver program in a function named <code>process_goto_program</code> or <code>process_goto_functions</code>; examples of these can be found in <code><a class="el" href="classcbmc__parse__optionst.html">cbmc_parse_optionst</a></code>, <code><a class="el" href="classgoto__analyzer__parse__optionst.html">goto_analyzer_parse_optionst</a></code> and <code><a class="el" href="classgoto__instrument__parse__optionst.html">goto_instrument_parse_optionst</a></code> among others.</p>
<h1><a class="anchor" id="section-lazy-conversion"></a>
Lazy GOTO Conversion</h1>
<p>The conventional source-code-to-GOTO-program pipeline is horizontally structured: all source-file information is converted into a symbol table, then each symbol-table method is converted into a GOTO program, then each transform is run over the whole GOTO-model in turn. This is fine when the GOTO model consumer will use most or all of the results of conversion, but if not then lazy conversion may be beneficial.</p>
<p>Lazy conversion is coordinated by <code><a class="el" href="classlazy__goto__modelt.html" title="A GOTO model that produces function bodies on demand.">lazy_goto_modelt</a></code>. Early source code parsing proceeds as usual, but while the same symbol table symbols are created as using <code>initialize_goto_model</code>, method bodies in the symbol table are not populated. <code><a class="el" href="classlazy__goto__modelt.html#a547f0cc34eb2eb0be1c29306cb4f91e2" title="Get a GOTO function body.">lazy_goto_modelt::get_goto_function</a></code> then allows each function to be converted on demand, passing individually through symbol-table <code>codet</code> production, GOTO conversion and driver-program transformation.</p>
<p><code><a class="el" href="classgoto__symext.html" title="The main class for the forward symbolic simulator.">goto_symext</a></code> is able to use such a lazy GOTO model in place of the usual <code><a class="el" href="classgoto__modelt.html">goto_modelt</a></code>, enabling it to create GOTO programs on demand, and thus avoid spending time and memory generating GOTO programs that symex determines cannot in fact be reached. This is particularly useful when the source program contains many indirect calls (virtual function calls, or calls via function pointer), as the <code>remove_virtual_functions</code> and <code>remove_function_pointers</code> passes treat these very conservatively, producing large dispatch tables of possible callees which symex often finds to be largely unreachable.</p>
<p>JBMC exhibits typical usage of <code><a class="el" href="classlazy__goto__modelt.html" title="A GOTO model that produces function bodies on demand.">lazy_goto_modelt</a></code> when it is called with <code>--symex-driven-lazy-loading</code>. It defines a function <code><a class="el" href="classjbmc__parse__optionst.html#a849e4b7d760ab9f6b340908c145fd35e">jbmc_parse_optionst::process_goto_function</a></code> which performs driver-program- specific post-GOTO-convert transformation. The lazy GOTO model is then passed to <code><a class="el" href="classgoto__symext.html" title="The main class for the forward symbolic simulator.">goto_symext</a></code>, which will trigger symbol-table population, GOTO conversion and post-processing as needed.</p>
<h1><a class="anchor" id="section-goto-binary"></a>
Binary Representation</h1>
<p>An instance of <code><a class="el" href="classgoto__modelt.html">goto_modelt</a></code> can be serialised to a binary stream (which is typically a file on the disk), and later deserialised from that stream back to an equivalent <code><a class="el" href="classgoto__modelt.html">goto_modelt</a></code> instance.</p>
<h2><a class="anchor" id="subsection-goto-binary-serialisation"></a>
Serialisation</h2>
<p>The serialisation is implemented in C++ modules:</p><ul>
<li><code><a class="el" href="write__goto__binary_8h.html">write_goto_binary.h</a></code></li>
<li><code><a class="el" href="write__goto__binary_8cpp.html">write_goto_binary.cpp</a></code></li>
</ul>
<p>To serialise a <code><a class="el" href="classgoto__modelt.html">goto_modelt</a></code> instance <code>gm</code> to a stream <code>ostr</code> call the function <code><a class="el" href="write__goto__binary_8h.html#aa9e8c0241174a3fbf8abaf9ab41774c8" title="Writes a goto program to disc.">write_goto_binary</a></code>, e.g. <code>write_goto_binary(ostr, gm)</code>.</p>
<p>The content of the written stream will have this structure:</p><ul>
<li>The header:<ul>
<li>A magic number: byte <code>0x7f</code> followed by 3 characters <code>GBF</code>.</li>
<li>A version number written in the 7-bit encoding (see <a class="el" href="group__util.html#irep-serialization-numbers">number serialisation</a>). Currently, only version <code>4</code> is supported.</li>
</ul>
</li>
<li>The symbol table:<ul>
<li>The number of symbols in the table in the 7-bit encoding.</li>
<li>The array of individual symbols in the table. Each written symbol <code>s</code> has this structure:<ul>
<li>The <code><a class="el" href="classirept.html" title="There are a large number of kinds of tree structured or tree-like data in CPROVER.">irept</a></code> instance <code>s.type</code>.</li>
<li>The <code><a class="el" href="classirept.html" title="There are a large number of kinds of tree structured or tree-like data in CPROVER.">irept</a></code> instance <code>s.value</code>.</li>
<li>The <code><a class="el" href="classirept.html" title="There are a large number of kinds of tree structured or tree-like data in CPROVER.">irept</a></code> instance <code>s.location</code>.</li>
<li>The string <code>s.name</code>.</li>
<li>The string <code>s.module</code>.</li>
<li>The string <code>s.base_name</code>.</li>
<li>The string <code>s.mode</code>.</li>
<li>The string <code>s.pretty_name</code>.</li>
<li>The number <code>0</code> in the 7-bit encoding.</li>
<li>The flags word in the 7-bit encoding. The bits in the flags word correspond to the following <code>Boolean</code> fields (from the most significant bit):<ul>
<li><code>s.is_weak</code></li>
<li><code>s.is_type</code></li>
<li><code>s.is_property</code></li>
<li><code>s.is_macro</code></li>
<li><code>s.is_exported</code></li>
<li><code>s.is_input</code></li>
<li><code>s.is_output</code></li>
<li><code>s.is_state_var</code></li>
<li><code>s.is_parameter</code></li>
<li><code>s.is_auxiliary</code></li>
<li><code>0</code> (corresponding to <code>s.binding</code>, i.e. we always clear this info)</li>
<li><code>s.is_lvalue</code></li>
<li><code>s.is_static_lifetime</code></li>
<li><code>s.is_thread_local</code></li>
<li><code>s.is_file_local</code></li>
<li><code>s.is_extern</code></li>
<li><code>s.is_volatile</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>The functions with bodies, i.e. those missing a body are skipped.<ul>
<li>The number of functions with bodies in the 7-bit encoding.</li>
<li>The array of individual functions with bodies. Each written function has this structure:<ul>
<li>The string with the name of the function.</li>
<li>The number of instructions in the body of the function in the 7-bit encoding.</li>
<li>The array of individual instructions in function's body. Each written instruction <code>I</code> has this structure:<ul>
<li>The <code><a class="el" href="classirept.html" title="There are a large number of kinds of tree structured or tree-like data in CPROVER.">irept</a></code> instance <code>I.code</code>, i.e. data of the instruction, like arguments.</li>
<li>The string <code>I.function</code>, i.e. the name of the function this instruction belongs to.</li>
<li>The <code><a class="el" href="classirept.html" title="There are a large number of kinds of tree structured or tree-like data in CPROVER.">irept</a></code> instance <code>I.source_location</code>, i.e. the reference to the original source code (file, line).</li>
<li>The word in the 7-bit encoding <code>I.type</code>, i.e. the op-code of the instruction.</li>
<li>The <code><a class="el" href="classirept.html" title="There are a large number of kinds of tree structured or tree-like data in CPROVER.">irept</a></code> instance <code>I.guard</code>.</li>
<li>The empty string (representing former <code>I.event</code>).</li>
<li>The word in the 7-bit encoding <code>I.target_number</code>, i.e. the jump target to this instruction from other instructions.</li>
<li>The word in the 7-bit encoding <code>I.targets.size()</code>, i.e. the count of jump targets from this instruction.</li>
<li>The array of individual jump targets from this instruction, each written as a word in the 7-bit encoding.</li>
<li>The word in the 7-bit encoding <code>I.labels.size()</code>.</li>
<li>The array of individual labels, each written as a word in the 7-bit encoding.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>An important propery of the serialisation is that each serialised <code><a class="el" href="classirept.html" title="There are a large number of kinds of tree structured or tree-like data in CPROVER.">irept</a></code> instance occurs in the stream exactly once. Namely, in the position of its first serialisation query. All other such queries save only a hash code (i.e. reference) of the <code><a class="el" href="classirept.html" title="There are a large number of kinds of tree structured or tree-like data in CPROVER.">irept</a></code> instance.</p>
<p>A similar strategy is used for serialisation of string constants shared amongst <code><a class="el" href="classirept.html" title="There are a large number of kinds of tree structured or tree-like data in CPROVER.">irept</a></code> instances. Such a string is fully saved only in the first serialisation query of an <code><a class="el" href="classirept.html" title="There are a large number of kinds of tree structured or tree-like data in CPROVER.">irept</a></code> instance it appears in and all other queries only save its integer hash code.</p>
<p>Details about serialisation of <code><a class="el" href="classirept.html" title="There are a large number of kinds of tree structured or tree-like data in CPROVER.">irept</a></code> instances, strings, and words in 7-bit encoding can be found <a class="el" href="group__util.html#irep-serialization">here</a>.</p>
<h2><a class="anchor" id="subsection-goto-binary-deserialisation"></a>
Deserialisation</h2>
<p>The deserialisation is implemented in C++ modules:</p><ul>
<li><code><a class="el" href="read__goto__binary_8h.html">read_goto_binary.h</a></code></li>
<li><code><a class="el" href="read__goto__binary_8cpp.html">read_goto_binary.cpp</a></code></li>
<li><code><a class="el" href="read__bin__goto__object_8h.html">read_bin_goto_object.h</a></code></li>
<li><code><a class="el" href="read__bin__goto__object_8cpp.html">read_bin_goto_object.cpp</a></code></li>
</ul>
<p>The first two modules are responsible for location of the stream with the serialised data within a passed file. And the remaining two modules perform the actual deserialisation of a <code><a class="el" href="classgoto__modelt.html">goto_modelt</a></code> instance from the located stream.</p>
<p>To deserialise a <code><a class="el" href="classgoto__modelt.html">goto_modelt</a></code> instance <code>gm</code> from a file <code>/some/path/name.gbf</code> call the function <code><a class="el" href="read__goto__binary_8h.html#a1176b2f0d40bcfc89ce8d86f7bb1e04a" title="Read a goto binary from a file, but do not update config.">read_goto_binary</a></code>, e.g. <code>read_goto_binary("/some/path/name.gbf", gm, message_handler)</code>, where <code>message_handler</code> must be an instance of <code><a class="el" href="classmessage__handlert.html">message_handlert</a></code> and serves for reporting issues during the process.</p>
<p>The passed binary file is assumed to have the same structure as described in the <a class="el" href="group__goto-programs.html#subsection-goto-binary-serialisation">previous subsection</a>. The process of the deserialisation does not involve any seeking in the file. The content is read linearly from the beginning to the end. <code><a class="el" href="classirept.html" title="There are a large number of kinds of tree structured or tree-like data in CPROVER.">irept</a></code> instances and their string constants are deserialised into the memory only once at their first occurrences in the stream. All subsequent deserialisation queries are resolved as in-memory references to already deserialised the <code><a class="el" href="classirept.html" title="There are a large number of kinds of tree structured or tree-like data in CPROVER.">irept</a></code> instances and/or strings, based on hash code matching.</p>
<p>NOTE: The first deserialisation is detected so that the loaded hash code is new. That implies that the full definition follows right after the hash.</p>
<p>Details about serialisation of <code><a class="el" href="classirept.html" title="There are a large number of kinds of tree structured or tree-like data in CPROVER.">irept</a></code> instances, strings, and words in 7-bit encoding can be found <a class="el" href="group__util.html#irep-serialization">here</a>.</p>
<h3><a class="anchor" id="subsection-goto-binary-deserialisation-from-elf"></a>
Deserialisation from ELF image</h3>
<p>One can decide to store the serialised stream as a separate section, named <code>goto-cc</code>, into an ELF image. Then the deserialisation has a support of automatic detection of that section in an ELF file and the deserialisation will be automatically started from that section.</p>
<p>For reading the ELF images there is used an instance of <code><a class="el" href="clasself__readert.html">elf_readert</a></code> implemented in the C++ module:</p><ul>
<li><code><a class="el" href="elf__reader_8h.html">elf_reader.h</a></code></li>
<li><code><a class="el" href="elf__reader_8cpp.html">elf_reader.cpp</a></code></li>
</ul>
<h3><a class="anchor" id="subsection-goto-binary-deserialisation-from-mach-o-fat-image"></a>
Deserialisation from Mach-O fat image</h3>
<p>One can decide to store the serialised stream into Mach-O fat image as a separate non-empty section with flags <code>CPU_TYPE_HPPA</code> and <code>CPU_SUBTYPE_HPPA_7100LC</code>. Then the deserialisation has a support of automatic detection of that section in a Mach-O fat image, extraction of the section from the emage into a temporary file (this is done by calling <code>lipo</code> utility with <code>-thin hppa7100LC</code> option), and the deserialisation will be automatically started from that temporary file.</p>
<p>For reading the Mach-O fat images there is used an instance of <code><a class="el" href="classosx__fat__readert.html">osx_fat_readert</a></code> implemented in the C++ module:</p><ul>
<li><code><a class="el" href="osx__fat__reader_8h.html">osx_fat_reader.h</a></code></li>
<li><code><a class="el" href="osx__fat__reader_8cpp.html">osx_fat_reader.cpp</a></code></li>
</ul>
<p>NOTE: This functionality is available only when the modules are built on a MacOS machine.</p>
<h3><a class="anchor" id="subsection-goto-binary-is-binary-file"></a>
Checking file type</h3>
<p>You can use function <code><a class="el" href="read__goto__binary_8h.html#aca447218d27c0cbd7806c330ccbaae31">is_goto_binary</a></code> to check whether a passed file contains a deserialised <code><a class="el" href="classgoto__modelt.html">goto_modelt</a></code> instance or not. This is done by checking the magic number of the stream (see subsection <a class="el" href="group__goto-programs.html#subsection-goto-binary-serialisation">Serialisation</a>). However, in the case when the deserialised data were stored into ELF or Mach-O fat image, then only the check for presence of the concrete section in the image is performed.</p>
<h3><a class="anchor" id="subsection-goto-binary-deserialisation-linking"></a>
Linking Goto Models</h3>
<p>Similar to linking of object files together by C/C++ linker, the module provides linking of a dereserialised <code><a class="el" href="classgoto__modelt.html">goto_modelt</a></code> instance into a given (i.e. previously deserialised or otherwise created) <code><a class="el" href="classgoto__modelt.html">goto_modelt</a></code> instance.</p>
<p>This is implemented in function <code><a class="el" href="read__goto__binary_8cpp.html#a6401988f978c39e1fb16e81850350fd0" title="reads an object file, and also updates config">read_object_and_link</a></code>. The function first deserialises the passed file into a temporary <code><a class="el" href="classgoto__modelt.html">goto_modelt</a></code> instance, and then it performs 'linking' of the temporary into a passed destination <code><a class="el" href="classgoto__modelt.html">goto_modelt</a></code> instance.</p>
<p>Details about linking of <code><a class="el" href="classgoto__modelt.html">goto_modelt</a></code> instances can be found <a class="el" href="group__goto-programs.html#section-linking-goto-models">here</a>.</p>
<h1><a class="anchor" id="section-linking-goto-models"></a>
Linking Goto Models</h1>
<p>C++ modules:</p><ul>
<li><code><a class="el" href="link__goto__model_8h.html">link_goto_model.h</a></code></li>
<li><code><a class="el" href="link__goto__model_8cpp.html">link_goto_model.cpp</a></code></li>
</ul>
<p>Dependencies:</p><ul>
<li><a class="el" href="group__linking.html">linking folder</a>.</li>
<li><a class="el" href="group__util.html#section-goto-typecheck">typecheck</a>.</li>
</ul>
<h1><a class="anchor" id="goto-trace-structure"></a>
Goto Trace Structure</h1>
<p>In the <a class="el" href="group__goto-programs.html">goto-programs</a> directory.</p>
<p><b>Key classes:</b></p><ul>
<li><a class="el" href="classgoto__tracet.html">goto_tracet</a></li>
<li><a class="el" href="classgoto__trace__stept.html">goto_trace_stept</a></li>
<li><a class="el" href="classgoto__trace__stept.html#a6cd0384a4a8c5dbfba0817c5972e5ebc">goto_trace_stept::typet</a></li>
</ul>
<p>A trace represents the execution of a program as a series of steps. The class <a class="el" href="classgoto__tracet.html">goto_tracet</a> contains an ordered list of <a class="el" href="classgoto__trace__stept.html">goto_trace_stept</a>, each representing a step. The main step types used in a program are:</p><ul>
<li>function call</li>
<li>function return</li>
<li>assignment</li>
</ul>
<p>There are many types of step in <a class="el" href="classgoto__trace__stept.html" title="Step of the trace of a GOTO program.">goto_trace_stept</a>, which are listed here: <a class="el" href="classgoto__trace__stept.html#a6cd0384a4a8c5dbfba0817c5972e5ebc">goto_trace_stept::typet</a>, but this overview will focus on the main types used.</p>
<h2><a class="anchor" id="general-step-structure"></a>
General Step Structure</h2>
<p>Every <a class="el" href="classgoto__trace__stept.html" title="Step of the trace of a GOTO program.">goto_trace_stept</a> has a type (<a class="el" href="classgoto__trace__stept.html#a6cd0384a4a8c5dbfba0817c5972e5ebc">goto_trace_stept::typet</a>), e.g. function call. The type of a step can be checked using the boolean functions such as <a class="el" href="classgoto__trace__stept.html#a175c36fe493323ff955638643c5bdc27">goto_trace_stept::is_function_call()</a>.</p>
<p>The meaning of the remainder of the members of <a class="el" href="classgoto__trace__stept.html" title="Step of the trace of a GOTO program.">goto_trace_stept</a> depend on the step type.</p>
<h2><a class="anchor" id="function-call-step-structure"></a>
Function Calls</h2>
<p>A function call step has the <a class="el" href="classgoto__trace__stept.html#a6cd0384a4a8c5dbfba0817c5972e5ebc">goto_trace_stept::typet</a> <a class="el" href="classgoto__trace__stept.html#a6cd0384a4a8c5dbfba0817c5972e5ebcafe8f37b06a5aa2e00985a4efffab6c2b">goto_trace_stept::typet::FUNCTION_CALL</a> and signifies that the program is calling a function. The step contains a valid identifier of the function being called (<a class="el" href="classgoto__trace__stept.html#aa5393083be5462b9ed4e3eca5a012a2b">goto_trace_stept::called_function</a>), a vector of the function arguments (<a class="el" href="classgoto__trace__stept.html#a0ba7914f623ed9ed32d8d8d04b6a5184">goto_trace_stept::function_arguments</a>) and the identifier of the function of the call site (<a class="el" href="classgoto__trace__stept.html#a6eae0f003b4a7de6048071af2dcf2e83">goto_trace_stept::function_id</a>).</p>
<p>Following a function call, <a class="el" href="group__goto-programs.html#assignment-step-structure">Assignment</a> assignments are made to each parameter, if there are any, including the <code>this</code> parameter.</p>
<h2><a class="anchor" id="function-return-step-structure"></a>
Function Return</h2>
<p>A function return step has the <a class="el" href="classgoto__trace__stept.html#a6cd0384a4a8c5dbfba0817c5972e5ebc">goto_trace_stept::typet</a> <a class="el" href="classgoto__trace__stept.html#a6cd0384a4a8c5dbfba0817c5972e5ebcabba24711ad921641fb7f9850bd3fa2f5">goto_trace_stept::typet::FUNCTION_RETURN</a> and signifies that the program is exiting a function. <a class="el" href="classgoto__trace__stept.html#a6eae0f003b4a7de6048071af2dcf2e83">goto_trace_stept::function_id</a> is the function being returned from.</p>
<p>If the function has a return value, an <a class="el" href="group__goto-programs.html#assignment-step-structure">Assignment</a> assignment will be made to a variable with identifier with suffix <a class="el" href="remove__returns_8cpp.html#a030731fe085458163fdff7dd5ef8cb66">RETURN_VALUE_SUFFIX</a>.</p>
<h2><a class="anchor" id="assignment-step-structure"></a>
Assignment</h2>
<p>An assignment step has the <a class="el" href="classgoto__trace__stept.html#a6cd0384a4a8c5dbfba0817c5972e5ebc">goto_trace_stept::typet</a> <a class="el" href="classgoto__trace__stept.html#a6cd0384a4a8c5dbfba0817c5972e5ebca791ff9f35e0ac7dbbf3a564c6ef98c83">goto_trace_stept::typet::ASSIGNMENT</a> and signifies that the program is making an assignment to a variable. For an assignment LHS = RHS, the step contains the symbol representing the LHS (<a class="el" href="classgoto__trace__stept.html#a0cf67b970ca1ab157e3bbe1cce688687">goto_trace_stept::full_lhs</a>) and the value expression representing the RHS (<a class="el" href="classgoto__trace__stept.html#a68ba24691fe7cea7ac661e228a9f9f89">goto_trace_stept::full_lhs_value</a>).</p>
<h2><a class="anchor" id="other-steps"></a>
Other steps</h2>
<p>In a trace of a program, there are other step types that are internal including:</p><ul>
<li><a class="el" href="classgoto__trace__stept.html#a6cd0384a4a8c5dbfba0817c5972e5ebca1edce3bd99a335da00a27703a24f3dfc">goto_trace_stept::typet::ASSERT</a> (failure), used in bytecode instrumentation and properties</li>
<li><a class="el" href="classgoto__trace__stept.html#a6cd0384a4a8c5dbfba0817c5972e5ebca71233d73cc90bba8f4d5bbea0792e551">goto_trace_stept::typet::LOCATION</a> (location-only), appears in the trace when the source location changes.</li>
</ul>
<h2><a class="anchor" id="java-assignments"></a>
Java Assignments</h2>
<p>See <a class="el" href="group__java__bytecode.html#java-trace">Java Trace Assumptions</a>. </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
