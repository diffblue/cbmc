<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CProver manual: goto-cc</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CProver manual
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">goto-cc </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href=".">CPROVER Manual TOC</a></p>
<h2><a class="anchor" id="integration-into-build-systems-with-goto-cc"></a>
Integration into Build Systems with goto-cc</h2>
<p>Existing software projects usually do not come in a single source file that may simply be passed to a model checker. Rather, they come in a multitude of source files in different directories and refer to external libraries and system-wide options. A <em>build system</em> then collects the configuration options from the system and compiles the software according to build rules.</p>
<p>The most prevalent build tool on Unix-based systems is the <code>make</code> utility. This tool uses build rules given in a <em>Makefile</em> that comes with the software sources. Running software verification tools on projects like these is greatly simplified by a compiler that first collects all the necessary models into a single model file. <a href="http://www.cprover.org/goto-cc/">goto-cc</a> is such a model file extractor, which can seamlessly replace <code>gcc</code> and <code>cl.exe</code> in Makefiles. The normal build system for the project may be used to build the software, but the outcome will be a model file with suitable detail for verification, as opposed to a flat executable program. Note that goto-cc comes in different variants depending on the compilation environment:</p>
<h3><a class="anchor" id="variants-of-goto-cc"></a>
Variants of goto-cc</h3>
<p>The goto-cc utility comes in several variants, summarised in the following table.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Executable   </th><th class="markdownTableHeadNone">Environment   </th><th class="markdownTableHeadNone">Preprocessor    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">goto-cc   </td><td class="markdownTableBodyNone"><a href="http://gcc.gnu.org/">gcc</a> (control-flow graph only)   </td><td class="markdownTableBodyNone">gcc -E    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">goto-gcc   </td><td class="markdownTableBodyNone"><a href="http://gcc.gnu.org/">gcc</a> (“hybrid” executable)   </td><td class="markdownTableBodyNone">gcc -E    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">goto-armcc   </td><td class="markdownTableBodyNone"><a href="http://arm.com/products/tools/software-tools/rvds/index.php">ARM RVDS</a>   </td><td class="markdownTableBodyNone">armcc -E    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">goto-cl   </td><td class="markdownTableBodyNone"><a href="http://www.microsoft.com/visualstudio/">Visual Studio</a>   </td><td class="markdownTableBodyNone">cl /E    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">goto-cw   </td><td class="markdownTableBodyNone"><a href="http://www.freescale.com/webapp/sps/site/homepage.jsp?code=CW_HOME">Freescale CodeWarrior</a>   </td><td class="markdownTableBodyNone">mwcceppc   </td></tr>
</table>
<p>The primary difference between the variants is the preprocessor called. Furthermore, the language recognized varies slightly. The variants can be obtained by simply renaming the goto-cc executable. On Linux/MacOS, the variants can be obtained by creating a symbolic link.</p>
<p>The “hybrid” executables contain both the control-flow graph for verification purposes and the usual, executable machine code.</p>
<h3><a class="anchor" id="example-building-wu-ftpd"></a>
Example: Building wu-ftpd</h3>
<p>This example assumes a Unix-like machine.</p>
<ol type="1">
<li>Download the sources of wu-ftpd from <a href="ftp:-ftp.wu-ftpd.org-pub-wu-ftpd-wu-ftpd-current.tar.gz.md">here</a>.</li>
<li>Unpack the sources by running <pre class="fragment">tar xfz wu-ftpd-current.tar.gz
</pre></li>
<li>Change to the source directory, for example by entering, <pre class="fragment">cd wu-ftpd-2.6.2
</pre></li>
<li>Configure the project for verification by running: <pre class="fragment">./configure YACC=byacc CC=goto-cc --host=none-none-none
</pre></li>
<li>Build the project by running <code>make</code>. This creates multiple model files in the <code>src</code> directory. Among them is a model for the main executable <code>ftpd</code>.</li>
<li>Run a model-checker, for example CBMC, on the model file: <pre class="fragment">cbmc src/ftpd
</pre> CBMC automatically recognizes that the file is a goto binary.</li>
</ol>
<h3><a class="anchor" id="important-notes"></a>
Important Notes</h3>
<p>More elaborate build or configuration scripts often make use of features of the compiler or the system library to detect configuration options automatically, for example, in a <code>configure</code> script. Replacing <code>gcc</code> by goto-cc at this stage may confuse the script, or detect incorrect options. For example, missing library functions do not cause goto-cc to throw an error (only to issue a warning). Because of this, configuration scripts sometimes falsely assume the availability of a system function or library.</p>
<p>In the case of this or similar problems, it is more advisable to configure the project using the normal routine, and replacing the compiler setting manually in the generated Makefiles, for example, by replacing lines like <code>CC=gcc</code> by <code>CC=goto-cc</code>.</p>
<p>A helpful command that accomplishes this task successfully for many projects is:</p>
<div class="fragment"><div class="line">for i in `find . -name Makefile`; do</div>
<div class="line">  sed -e &#39;s/^\&zwj;(\s*CC[ \t]*=\&zwj;)\&zwj;(.*$\&zwj;)/\1goto-cc/g&#39; -i $i</div>
<div class="line">done</div>
</div><!-- fragment --><p>Here are additional examples on how to use goto-cc:</p>
<ul>
<li>man_goto-cc-linux “Linux Kernel”</li>
<li>man_goto-cc-apache “Apache HTTPD”</li>
</ul>
<p>A description of how to integrate goto-cc into Microsoft’s Visual Studio is man_instrumentation-vs “here”.</p>
<h3><a class="anchor" id="linking-libraries"></a>
Linking Libraries</h3>
<p>Some software projects come with their own libraries. Also, the goal may be to analyze a library by itself. For this purpose it is possible to use goto-cc to link multiple model files into a library of model files. An object file can then be linked against this model library. For this purpose, goto-cc also features a linker mode.</p>
<p>To enable this linker mode, create a link to the goto-cc binary by the name of goto-ld (Linux and Mac) or copy the goto-cc binary to goto-link.exe (Windows). The goto-ld tool can now be used as a seamless replacement for the <code>ld</code> tool present on most Unix (-based) systems and for the <code>link</code> tool on Windows.</p>
<p>The default linker may need to be replaced by <code>goto-ld</code> or <code>goto-link.exe</code> in the build script, which can be achieved in much the same way as replacing the compiler.</p>
<h2><a class="anchor" id="architectural-settings"></a>
Architectural Settings</h2>
<p>The behavior of a C/C++ program depends on a number of parameters that are specific to the architecture the program was compiled for. The three most important architectural parameters are:</p>
<ul>
<li>The width of the various scalar types; for example, compare the value of <code>sizeof(long int)</code> on various machines.</li>
<li>The width of pointers; for example, compare the value of <code>sizeof(int *)</code> on various machines.</li>
<li>The <a href="http://en.wikipedia.org/wiki/Endianness">endianness</a> of the architecture.</li>
</ul>
<p>In general, the CPROVER tools attempt to adopt the settings of the particular architecture the tool itself was compiled for. For example, when running a 64-bit binary of CBMC on Linux, the program will be processed assuming that <code>sizeof(long int)==8</code>.</p>
<p>As a consequence of these architectural parameters, you may observe different verification results for an identical program when running CBMC on different machines. In order to get consistent results, or when aiming at validating a program written for a different platform, the following command-line arguments can be passed to the CPROVER tools:</p>
<ul>
<li>The word-width can be set with <code>--16</code>, <code>--32</code>, <code>--64</code>.</li>
<li>The endianness can be defined with <code>--little-endian</code> and <code>--big-endian</code>.</li>
</ul>
<p>When using a goto binary, CBMC and the other tools read the configuration from the binary. The setting when running goto-cc is the one that matters; the option given to the model checker is ignored in this case.</p>
<p>In order to see the effect of the options <code>--16</code>, <code>--32</code> and <code>--64</code>, pass the following program to CBMC:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;assert.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">  printf(<span class="stringliteral">&quot;sizeof(long int): %d\n&quot;</span>, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">long</span> <span class="keywordtype">int</span>));</div>
<div class="line">  printf(<span class="stringliteral">&quot;sizeof(int *): %d\n&quot;</span>, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">int</span> *));</div>
<div class="line">  assert(0);</div>
<div class="line">}</div>
</div><!-- fragment --><p>The counterexample trace contains the strings printed by the <code>printf</code> command.</p>
<p>The effects of endianness are more subtle. Try the following program with <code>--big-endian</code> and <code>--little-endian</code>:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;assert.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">  <span class="keywordtype">int</span> i=0x01020304;</div>
<div class="line">  <span class="keywordtype">char</span> *p=(<span class="keywordtype">char</span> *)&amp;i;</div>
<div class="line">  printf(<span class="stringliteral">&quot;Bytes of i: %d, %d, %d, %d\n&quot;</span>, p[0], p[1], p[2], p[3]);</div>
<div class="line">  assert(0);</div>
<div class="line">}</div>
</div><!-- fragment --><p>Last modified: 2024-05-06 10:47:46 +0200 </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
