<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CBMC: ansi-c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CBMC
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__ansi-c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">ansi-c</div>  </div>
</div><!--header-->
<div class="contents">
<h1><a class="anchor" id="autotoc_md7"></a>
Folder ansi-c</h1>
<dl class="section author"><dt>Author</dt><dd>Kareem Khazem, Martin Brain</dd></dl>
<h1><a class="anchor" id="overview"></a>
Overview</h1>
<p>Contains the front-end for ANSI C, plus a variety of common extensions. This parses the file, performs some basic sanity checks (this is one area in which the UI could be improved; patches most welcome) and then produces a goto-program (see below). The parser is a traditional Flex / Bison system.</p>
<p><code>internal_addition.c</code> contains the implementation of various ‘magic’ functions that are that allow control of the analysis from the source code level. These include assertions, assumptions, atomic blocks, memory fences and rounding modes.</p>
<p>The <code>library/</code> subdirectory contains versions of some of the C standard header files that make use of the CPROVER built-in functions. This allows CPROVER programs to be ‘aware’ of the functionality and model it correctly. Examples include <code><a class="el" href="stdio_8c.html">stdio.c</a></code>, <code><a class="el" href="string_8c.html">string.c</a></code>, <code><a class="el" href="setjmp_8c.html">setjmp.c</a></code> and various threading interfaces.</p>
<h1><a class="anchor" id="preprocessing"></a>
Preprocessing &amp; Parsing</h1>
<p>In the <a class="el" href="group__ansi-c.html">ansi-c</a> directory</p>
<p><b>Key classes:</b></p><ul>
<li><a class="el" href="classlanguaget.html">languaget</a> and its subclasses</li>
<li><a class="el" href="classansi__c__parse__treet.html">ansi_c_parse_treet</a></li>
</ul>
<div class="dotgraph">
<iframe scrolling="no" frameborder="0" src="dot_inline_dotgraph_15.svg" width="931" height="59"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<h1><a class="anchor" id="type-checking"></a>
Type-checking</h1>
<p>In the <a class="el" href="group__ansi-c.html">ansi-c</a> directory</p>
<p><b>Key classes:</b></p><ul>
<li><a class="el" href="classlanguaget.html">languaget</a> and its subclasses</li>
<li><a class="el" href="classirept.html">irept</a></li>
<li><a class="el" href="irep_8h.html#a1ad4faefa9ca542d481e74be9cc01c2c">irep_idt</a></li>
<li><a class="el" href="classsymbolt.html">symbolt</a></li>
<li><a class="el" href="classsymbol__tablet.html" title="The symbol table.">symbol_tablet</a></li>
</ul>
<div class="dotgraph">
<iframe scrolling="no" frameborder="0" src="dot_inline_dotgraph_16.svg" width="630" height="59"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<p>This stage generates a symbol table, mapping identifiers to symbols; <a class="el" href="classsymbolt.html">symbols</a> are tuples of (value, type, location, flags).</p>
<p>This is a good point to introduce the <a class="el" href="classirept.html">irept</a> ("internal
representation") class&mdash;the base type of many of CBMC's hierarchical data structures. In particular, <a class="el" href="classexprt.html">expressions</a>, <a class="el" href="classtypet.html">types</a> and <a class="el" href="classcodet.html">statements</a> are all subtypes of <a class="el" href="classirept.html">irept</a>. An irep is a tree of ireps. A subtlety is that an irep is actually the root of <em>three</em> (possibly empty) trees, i.e. it has three disjoint sets of children: <a class="el" href="classirept.html#a0ca41d4d612e6245e1225cb2ebeef6eb">irept::get_sub()</a> returns a list of children, and <a class="el" href="classirept.html#a42ee9bb9f5ef8ce2c3069496620462f6">irept::get_named_sub()</a> returns an association from names to children. <b>Most clients never use these functions directly</b>, as subtypes of irept generally provide more descriptive functions. For example, the operands of an <a class="el" href="classexprt.html">expression</a> (<a class="el" href="classexprt.html#aa720c8b89fba1d2d38b230e0ed6cd2b2">op0</a>, op1 etc) are really that expression's children; the <a class="el" href="classcode__assignt.html#a6efd1dd283c032bf2330c573dfbeada5">left-hand</a> and right-hand side of an <a class="el" href="classcode__assignt.html">assignment</a> are the children of that assignment. The <a class="el" href="classirept.html#a0fd0f0b7d9f7e9a01f503d596333eb06">irept::pretty()</a> function provides a descriptive string representation of an irep.</p>
<p><a class="el" href="irep_8h.html#a1ad4faefa9ca542d481e74be9cc01c2c">irep_idts</a> ("identifiers") are strings that use sharing to improve memory consumption. A common pattern is a map from irep_idts to ireps. A goto-program contains a single symbol table (with a single scope), meaning that the names of identifiers in the target program are lightly mangled in order to make them globally unique. If there is an identifier <code>foo</code> in the target program, the <code>name</code> field of <code>foo</code>'s <a class="el" href="classsymbolt.html">symbol</a> in the goto-program will be</p><ul>
<li><code>foo</code> if it is global;</li>
<li><code>bar::foo</code> if it is a parameter to a function <code>bar()</code>;</li>
<li><code>bar::3::foo</code> if it is a local variable in a function <code>bar()</code>, where <code>3</code> is a counter that is incremented every time a newly-scoped <code>foo</code> is encountered in that function.</li>
</ul>
<p>The use of <em>sharing</em> to save memory is a pervasive design decision in the implementation of ireps and identifiers. Sharing makes equality comparisons fast (as there is no need to traverse entire trees), and this is especially important given the large number of map lookups throughout the codebase. More importantly, the use of sharing saves vast amounts of memory, as there is plenty of duplication within the goto-program data structures. For example, every statement, and every sub-expression of a statement, contains a <a class="el" href="classsource__locationt.html">source_locationt</a> that indicates the source file and location that it came from. Every symbol in every expression has a field indicating its type and location; etc. Although each of these are constructed as separate objects, the values that they eventually point to are shared throughout the codebase, decreasing memory consumption dramatically.</p>
<p>The Type Checking stage turns a parse tree into a <a class="el" href="classsymbol__tablet.html">symbol table</a>. In this context, the 'symbols' consist of code statements as well as what might more traditionally be called symbols. Thus, for example:</p><ul>
<li>The statement <code>int foo = 11;</code> is converted into a symbol whose type is <a class="el" href="classinteger__typet.html" title="Unbounded, signed integers (mathematical integers, not bitvectors)">integer_typet</a> and value is the <a class="el" href="classconstant__exprt.html">constant expression</a> <code>11</code>; that symbol is stored in the symbol table using the mangled name of <code>foo</code> as the key;</li>
<li>The function definition <code>void foo(){ int x = 11; bar(); }</code> is converted into a symbol whose type is <a class="el" href="classcode__typet.html">code_typet</a> (not to be confused with <a class="el" href="classtypet.html">typet</a> or <a class="el" href="classcodet.html">codet</a>!); the <a class="el" href="classcode__typet.html" title="Base type of functions.">code_typet</a> contains the parameter and return types of the function. The value of the symbol is the function's body (a <a class="el" href="classcodet.html">codet</a>), and the symbol is stored in the symbol table with <code>foo</code> as the key.</li>
</ul>
<h1><a class="anchor" id="performance"></a>
Parsing performance considerations</h1>
<ul>
<li>Measured on trunk/regression/ansi-c/windows_h_VS_2012/main.i</li>
<li>13%: Copying into i_preprocessed</li>
<li>5%: ansi_c_parser.read()</li>
<li>53%: <a class="el" href="cpp__token__buffer_8cpp.html#a3af4acd8d6869d5063984319d8fdf733">yyansi_clex()</a></li>
<li>29%: parser (without typechecking)</li>
</ul>
<h1><a class="anchor" id="references"></a>
Compiler References</h1>
<p>CodeWarrior C Compilers Reference 3.2:</p>
<p><a href="http://cache.freescale.com/files/soft_dev_tools/doc/ref_manual/CCOMPILERRM.pdf">http://cache.freescale.com/files/soft_dev_tools/doc/ref_manual/CCOMPILERRM.pdf</a></p>
<p><a href="http://cache.freescale.com/files/soft_dev_tools/doc/ref_manual/ASMX86RM.pdf">http://cache.freescale.com/files/soft_dev_tools/doc/ref_manual/ASMX86RM.pdf</a></p>
<p>ARM 4.1 Compiler Reference:</p>
<p><a href="http://infocenter.arm.com/help/topic/com.arm.doc.dui0491c/DUI0491C_arm_compiler_reference.pdf">http://infocenter.arm.com/help/topic/com.arm.doc.dui0491c/DUI0491C_arm_compiler_reference.pdf</a> </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
